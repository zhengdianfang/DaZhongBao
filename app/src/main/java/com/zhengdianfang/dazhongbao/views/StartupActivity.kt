package com.zhengdianfang.dazhongbao.viewsimport android.content.Intentimport android.os.Bundleimport android.preference.PreferenceManagerimport com.bumptech.glide.Glideimport com.bumptech.glide.request.RequestOptionsimport com.miracle.redux.Storeimport com.zhengdianfang.dazhongbao.CApplicationimport com.zhengdianfang.dazhongbao.Rimport com.zhengdianfang.dazhongbao.middleware.PersistenceMiddlewareimport com.zhengdianfang.dazhongbao.reducers.MyProductReducerimport com.zhengdianfang.dazhongbao.reducers.RootReducerimport com.zhengdianfang.dazhongbao.views.basic.BaseActivityimport com.zhengdianfang.dazhongbao.views.home.MainActivityimport com.zhengdianfang.dazhongbao.views.login.LoginActivityimport jp.wasabeef.glide.transformations.RoundedCornersTransformation/** * Created by dfgzheng on 25/07/2017. */class StartupActivity: BaseActivity() {    private val persistenceMiddleware by lazy {  PersistenceMiddleware(PreferenceManager.getDefaultSharedPreferences(this.applicationContext)) }    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_startup)        Glide.with(this).load(R.mipmap.ic_launcher).apply(RequestOptions().transform(RoundedCornersTransformation(this.applicationContext, 10, 0,                RoundedCornersTransformation.CornerType.ALL))).into(findViewById(R.id.imageView))        persistenceMiddleware.getStore().subscribe {state ->            CApplication.INSTANCE.store =  Store.create(RootReducer(arrayOf(MyProductReducer())), state , persistenceMiddleware)            if (CApplication.INSTANCE.isLogin()){                startActivity(Intent(this, MainActivity::class.java))            }else {                startActivity(Intent(this, LoginActivity::class.java))            }            finish()        }    }}